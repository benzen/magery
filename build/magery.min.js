var Magery=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{},id:r,loaded:false};e[r].call(i.exports,i,i.exports,n);i.loaded=true;return i.exports}n.m=e;n.c=t;n.p="";return n(0)}([function(e,t,n){e.exports={compile:n(1),Template:n(4),lookup:n(2).lookup,Patcher:n(5).Patcher,patch:n(5).patch}},function(module,exports,__webpack_require__){var utils=__webpack_require__(2);var html=__webpack_require__(3);var HTML_TAGS=["A","ABBR","ACRONYM","ADDRESS","APPLET","AREA","ARTICLE","ASIDE","AUDIO","B","BASE","BASEFONT","BDI","BDO","BGSOUND","BIG","BLINK","BLOCKQUOTE","BODY","BR","BUTTON","CANVAS","CAPTION","CENTER","CITE","CODE","COL","COLGROUP","COMMAND","CONTENT","DATA","DATALIST","DD","DEL","DETAILS","DFN","DIALOG","DIR","DIV","DL","DT","ELEMENT","EM","EMBED","FIELDSET","FIGCAPTION","FIGURE","FONT","FOOTER","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HEAD","HEADER","HGROUP","HR","HTML","I","IFRAME","IMAGE","IMG","INPUT","INS","ISINDEX","KBD","KEYGEN","LABEL","LEGEND","LI","LINK","LISTING","MAIN","MAP","MARK","MARQUEE","MENU","MENUITEM","META","METER","MULTICOL","NAV","NOBR","NOEMBED","NOFRAMES","NOSCRIPT","OBJECT","OL","OPTGROUP","OPTION","OUTPUT","P","PARAM","PICTURE","PLAINTEXT","PRE","PROGRESS","Q","RP","RT","RTC","RUBY","S","SAMP","SCRIPT","SECTION","SELECT","SHADOW","SLOT","SMALL","SOURCE","SPACER","SPAN","STRIKE","STRONG","STYLE","SUB","SUMMARY","SUP","TABLE","TBODY","TD","TEMPLATE","TEXTAREA","TFOOT","TH","THEAD","TIME","TITLE","TR","TRACK","TT","U","UL","VAR","VIDEO","WBR","XMP"];var IGNORED_ATTRS=["data-each","data-if","data-unless","data-key"];function compileLookup(e){return"p.lookup(data, "+JSON.stringify(e)+")"}function compileTemplateContext(e){var t=[];utils.eachAttribute(e,function(e,n){if(IGNORED_ATTRS.indexOf(e)===-1){t.push(JSON.stringify(e)+": "+compileExpandVariables(n))}});return"{"+t.join(", ")+"}"}function compileElement(e,t,n,r){if(e.tagName==="TEMPLATE-CHILDREN"){n("inner();\n");return}if(!r&&e.dataset.template){t.push(e);n("p.render(templates, "+JSON.stringify(e.dataset.template)+", data);\n");return}if(e.dataset.each){var i=e.dataset.each.split(/\s+in\s+/);var a=i[0];var s=utils.propertyPath(i[1]);n("p.each("+"data, "+JSON.stringify(a)+", "+compileLookup(s)+", "+"function (data) {\n")}if(e.dataset.if){var o=utils.propertyPath(e.dataset.if);n("if (p.isTruthy("+compileLookup(o)+")) {\n")}if(e.dataset.unless){var u=utils.propertyPath(e.dataset.unless);n("if (!p.isTruthy("+compileLookup(u)+")) {\n")}var l=true;if(HTML_TAGS.indexOf(e.tagName)===-1){n("p.render("+"templates"+", "+JSON.stringify(e.tagName.toLowerCase())+", "+compileTemplateContext(e)+", "+(e.dataset.key?compileExpandVariables(e.dataset.key):"null")+(e.childNodes.length?", function () {":");")+"\n");l=false}else{if(r){if(e.dataset.key){n("p.enterTag("+JSON.stringify(e.tagName)+", "+"root_key || "+compileExpandVariables(e.dataset.key)+");\n")}else{n("p.enterTag("+JSON.stringify(e.tagName)+", root_key || null);\n")}}else if(e.dataset.key){n("p.enterTag("+JSON.stringify(e.tagName)+", "+compileExpandVariables(e.dataset.key)+");\n")}else{n("p.enterTag("+JSON.stringify(e.tagName)+", null);\n")}utils.eachAttribute(e,function(e,t){if(e==="data-template"){e="data-bind"}if(IGNORED_ATTRS.indexOf(e)!==-1){return}var r=e.match(/^on(.*)/);if(r){var i=r[1];n("p.eventListener("+JSON.stringify(r[1])+", "+JSON.stringify(t)+", "+"data, template);\n")}else if(html.attributes[e]&html.BOOLEAN_ATTRIBUTE){if(t===""){n("p.attribute("+JSON.stringify(e)+", true);\n")}else{n("if (p.isTruthy("+compileExpandVariables(t)+")) {\n");n("p.attribute("+JSON.stringify(e)+", true);\n");n("}\n")}}else{n("p.attribute("+JSON.stringify(e)+", "+compileExpandVariables(t)+");\n")}})}utils.eachNode(e.childNodes,function(e){compileNode(e,t,n,false)});if(l){n("p.exitTag();\n")}else if(e.childNodes.length){n("});\n")}if(e.dataset.unless){n("}\n")}if(e.dataset.if){n("}\n")}if(e.dataset.each){n("});\n")}}function compileExpandVariables(e,t){var n=e.split(/{{\s*|\s*}}/);var r=n.length;var i=-1;while(++i<r){if(i%2){var a=utils.propertyPath(n[i]);n[i]=a}}if(r==1&&!n[0]&&t){return"true"}var s=[];var o=-1;while(++o<r){if(n[o].length){s.push(o%2?compileLookup(n[o]):JSON.stringify(n[o]))}}if(!s.length){return JSON.stringify("")}return s.join(" + ")}function compileText(e,t){var n=compileExpandVariables(e.textContent);if(n[0]==='"'){t("p.text("+n+");\n")}else{t('p.text("" + '+n+");\n")}}function compileDocumentFragment(e,t,n){utils.eachNode(e.childNodes,function(e){compileNode(e,t,n,false)})}function compileNode(e,t,n,r){switch(e.nodeType){case 1:compileElement(e,t,n,r);break;case 3:compileText(e,n);break;case 11:compileDocumentFragment(e,t,n);break}}function noop(){}exports.compile=function(e,t){var n=[];compileNode(e,n,noop,true);t("({\n");while(n.length){e=n.shift();t(JSON.stringify(e.dataset.template)+": ");t("new Magery.Template(function (template, templates, p, data, root_key, inner) {\n");compileNode(e,n,t,true);t("})"+(n.length?",":"")+"\n")}t("})\n")};exports.compileToString=function(e){var t="";exports.compile(e,function(e){t+=e});return t};exports.eval=function(node){return eval(exports.compileToString(node))}},function(e,t){var n=1;var r=3;var i=11;t.isDocumentFragment=function(e){return e.nodeType===i};t.isElementNode=function(e){return e.nodeType===n};t.isTextNode=function(e){return e.nodeType===r};t.eachNode=function(e,t){var n=0;var r=e[0];while(r){var i=r;r=r.nextSibling;t(i,n++,e)}};t.mapNodes=function(e,n){var r=[];t.eachNode(e,function(t,i){r[i]=n(t,i,e)});return r};t.trim=function(e){return e.replace(/^\s+|\s+$/g,"")};t.propertyPath=function(e){return e.split(".").filter(function(e){return e})};t.lookup=function(e,t){var n=e;for(var r=0,i=t.length;r<i;r++){if(n===undefined||n===null){return""}n=n[t[r]]}return n===undefined||n===null?"":n};t.templateTagName=function(e){var t=/^TEMPLATE-([^\s/>]+)/.exec(e.tagName);return t&&t[1].toLowerCase()};t.shallowClone=function(e){var t={};for(var n in e){t[n]=e[n]}return t};t.eachAttribute=function(e,t){var n=e.attributes;for(var r=0,i=e.attributes.length;r<i;r++){t(e.attributes[r].name,e.attributes[r].value)}}},function(e,t){var n=t.BOOLEAN_ATTRIBUTE=1;var r=t.USE_PROPERTY=2;t.attributes={allowfullscreen:n,async:n,autofocus:n,autoplay:n,capture:n,checked:n|r,controls:n,default:n,defer:n,disabled:n,formnovalidate:n,hidden:n,itemscope:n,loop:n,multiple:n|r,muted:n|r,novalidate:n,open:n,readonly:n,required:n,reversed:n,selected:n|r,value:r}},function(e,t){function n(e){this._render=e;this.handlers={}}n.prototype.bind=function(e){this.handlers=e};e.exports=n},function(e,t,n){var r=n(6);var i=n(2);var a=n(7);var s=1;var o=3;function u(e,t,n){return(e.tagName===t||e.nodeType===o&&t==="#text")&&e.key==n}function l(e,t,n,r){if(t&&u(t,n,r)){return t}if(r&&e.keymap){return e.keymap[r]||null}return null}function p(e,t,n){while(n){var r=n;n=n.nextSibling;e.removeChild(t,r)}}function f(e,t){var n=t.attributes;var r=[];var i,a;for(i=0,a=n.length;i<a;i++){var s=n[i];if(!t.visited_attributes.has(s.name)){r.push(s.name)}}for(i=0,a=r.length;i<a;i++){e.removeAttribute(t,r[i]);if(r[i]==="value"){e.removeEventListener(t,"input",N)}}}function c(e,t){if(!t.handlers){return}for(var n in t.handlers){if(!t.visited_events.has(n)){e.removeEventListener(t,n,t.handlers[n]);delete t.handlers[n]}}}function d(e,t){this.transforms=t||r;this.root=e;this.reset()}t.Patcher=d;d.prototype.reset=function(){this.parent=this.root.parentNode;this.current=this.root};d.prototype.stepInto=function(e){if(e.visited_attributes){e.visited_attributes.clear()}else{e.visited_attributes=new a}if(e.visited_events){e.visited_events.clear()}else{e.visited_events=new a}this.parent=e;this.current=e.firstChild};d.prototype.enterTag=function(e,t){var n=l(this.parent,this.current,e,t);if(!n){n=this.transforms.insertElement(this.parent,this.current,e);if(t){if(!this.parent.keymap){this.parent.keymap={}}this.parent.keymap[t]=n;n.key=t}}else if(!this.current){this.transforms.appendChild(this.parent,n)}else if(n!==this.current){this.transforms.replaceChild(this.parent,n,this.current)}this.stepInto(n)};function h(e){return function(t){var n=t.target;var r=n.handlers[e];if(r.name){var a=r.args.map(function(e){if(e.length==1&&e[0]=="event"){return t}return i.lookup(n.data,e)});n.template.handlers[r.name].apply(null,a)}if(n.tagName==="INPUT"){var s=n.getAttribute("type");if(e=="change"){if(s==="checkbox"){m(t)}else if(s==="radio"){T(t)}}else if(e=="input"&&n.hasAttribute("value")){N(t)}}else if(n.tagName==="SELECT"){E(t)}}}function v(e,t){if(!e.handlers){e.handlers={}}if(!e.handlers.hasOwnProperty(t)){var n=h(t);e.handlers[t]={fn:n};e.addEventListener(t,n)}}d.prototype.eventListener=function(e,t,n,r){var a=this.parent;if(a.data!==n){a.data=n}if(a.template!==r){a.template=r}v(a,e);var s=a.handlers[e];if(s.value!==t){s.value=t;var o=t.indexOf("(");var u=t.lastIndexOf(")");s.name=t.substring(0,o);var l=t.substring(o+1,u).split(",");s.args=l.map(function(e){return i.propertyPath(i.trim(e))})}a.visited_events.add(e)};function m(e){var t=e.target;if(t.dataset["managed"]==="true"){t.checked=t.hasAttribute("checked")}}function T(e){var t=e.target;if(t.dataset["managed"]==="true"){var n=t.hasAttribute("checked");if(t.checked!=n){if(t.name){var r=document.getElementsByName(t.name);for(var i=0,a=r.length;i<a;i++){var s=r[i];s.checked=s.hasAttribute("checked")}}else{t.checked=n}}}}function E(e){var t=e.target;if(t.dataset["managed"]==="true"){var n=t.getElementsByTagName("option");for(var r=0,i=n.length;r<i;r++){var a=n[r];a.selected=a.hasAttribute("selected")}}}function N(e){var t=e.target;if(t.dataset["managed"]==="true"){var n=t.getAttribute("value");if(t.value!==n){t.value=n}}}d.prototype.attribute=function(e,t){var n=this.parent;if(n.getAttribute(e)!==t){this.transforms.setAttribute(n,e,t)}n.visited_attributes.add(e)};d.prototype.text=function(e){var t=l(this.parent,this.current,"#text",null);if(!t){t=this.transforms.insertTextNode(this.parent,this.current,e)}else if(t.textContent!==e){this.transforms.replaceText(t,e)}this.current=t.nextSibling};function g(e,t){return e.handlers&&e.handlers[t]&&e.handlers[t].fn}d.prototype.exitTag=function(){p(this.transforms,this.parent,this.current);var e=this.parent;this.parent=e.parentNode;this.current=e.nextSibling;f(this.transforms,e);c(this.transforms,e);if(e.tagName==="INPUT"){var t=e.getAttribute("type");if((t==="checkbox"||t=="radio")&&!g(e,"change")){v(e,"change")}else if(e.hasAttribute("value")&&!g(e,"input")){v(e,"input")}}else if(e.tagName==="SELECT"){v(e,"change")}};d.prototype.skip=function(e,t){var n=l(this.parent,this.current,e,t);if(!this.current){this.transforms.appendChild(this.parent,n)}else if(n!==this.current){this.transforms.replaceChild(this.parent,n,this.current)}this.current=n.nextSibling};d.prototype.lookup=i.lookup;d.prototype.isTruthy=function(e){if(Array.isArray(e)){return e.length>0}return e};d.prototype.each=function(e,t,n,r){for(var a=0,s=n.length;a<s;a++){var o=i.shallowClone(e);o[t]=n[a];r(o)}};d.prototype.render=function(e,t,n,r,i){var a=e[t];a._render(a,e,this,n,r,i)};t.patch=function(e,t,n,r){new d(e).render(t,n,r)}},function(e,t,n){var r=n(3);t.insertTextNode=function(e,t,n){var r=document.createTextNode(n);e.insertBefore(r,t);return r};t.replaceText=function(e,t){e.textContent=t;return e};t.replaceChild=function(e,t,n){e.replaceChild(t,n);return t};t.appendChild=function(e,t){e.appendChild(t);return t};t.insertElement=function(e,t,n){var r=document.createElement(n);e.insertBefore(r,t);return r};t.removeChild=function(e,t){e.removeChild(t);return t};t.setAttribute=function(e,t,n){if(r.attributes[t]&r.USE_PROPERTY){e[t]=n}e.setAttribute(t,n);return e};t.removeAttribute=function(e,t){if(r.attributes[t]&r.USE_PROPERTY){e[t]=false}e.removeAttribute(t);return e};t.addEventListener=function(e,t,n){e.addEventListener(t,n,false);return e};t.removeEventListener=function(e,t,n){e.removeEventListener(t,n);return e}},function(e,t){if(typeof Set==="undefined"){function n(){this.values=[]}n.prototype.add=function(e){this.values.push(e)};n.prototype.has=function(e){return this.values.indexOf(e)!==-1};n.prototype.clear=function(){this.values=[]};e.exports=n}else{e.exports=Set}}]);